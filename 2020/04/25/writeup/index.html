<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Dang Yanlin">


    <meta name="subtitle" content="linlin">


    <meta name="description" content="逆向 re 网络安全 二进制">



<title>一次ctf比赛部分wp | WalkerRev&#39;s blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 4.2.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Linlin&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">博客</a>
                
                    <a class="menu-item" href="/category">目录</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="https://me.csdn.net/qq_42689353" target="_blank" rel="noopener">CSDN</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Linlin&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">博客</a>
                
                    <a class="menu-item" href="/category">目录</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="https://me.csdn.net/qq_42689353" target="_blank" rel="noopener">CSDN</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">一次ctf比赛部分wp</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Dang Yanlin</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">April 25, 2020&nbsp;&nbsp;19:13:37</a>
                        </span>
                    
                    
	<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  字数统计: </span>
        <span class="post-count">459字</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  阅读时长: </span>
        <span class="post-count">2分</span>
      </span>
    </span>
</div>
           
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="RE1"><a href="#RE1" class="headerlink" title="RE1"></a>RE1</h2><p>先看第一道RE题，打开这个程序，随便输入一下</p>
<p><img src="image-20200425174219323.png" alt="alt"></p>
<p>结果是这个样子，用ida打开</p>
<p><img src="image-20200425174657580.png" alt="image-20200425174657580"></p>
<p>这段代码很好理解，就是先输入一个flag，然后在比较，结果呢，无论比较没比较他都得不到flag，结合题目来看的话，意思是没调用显示flag这个函数，然后的话，用OD打开看下</p>
<p><img src="image-20200425175019701.png" alt="image-20200425175019701"></p>
<p>然后查看一下字符串</p>
<p><img src="image-20200425175148359.png" alt="image-20200425175148359">发现上面三行字符串很诡异，我们在反汇编窗口查看一下，</p>
<p><img src="image-20200425175309965.png" alt="image-20200425175309965"></p>
<p>发现会弹出两个窗口，想一下，绝大多数会弹出flag,把这个函数的入口地址保存一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00401020</span><br></pre></td></tr></table></figure>

<p>然后跳转到这个地址<img src="image-20200425175640124.png" alt="image-20200425175640124"></p>
<p><img src="image-20200425175659535.png" alt="image-20200425175659535"></p>
<p>然后运行一下</p>
<p><img src="image-20200425175753835.png" alt="image-20200425175753835"></p>
<p>提示要用base64解码</p>
<p>继续运行</p>
<p><img src="image-20200425175849425.png" alt="image-20200425175849425"></p>
<p>弹出flag</p>
<p>然后使用base64解码即可</p>
<p><img src="image-20200425180107603.png" alt="image-20200425180107603"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;I_L1ke_C++_Pr1mer~~~&#125;</span><br></pre></td></tr></table></figure>

<h2 id="RE2"><a href="#RE2" class="headerlink" title="RE2"></a>RE2</h2><p>这道题的话打开的话是这个样子的</p>
<p><img src="image-20200425180408665.png" alt="image-20200425180408665"></p>
<p>这让人咋玩？猜想输入框可能不对劲，打开看一下，很明显，都跑外面去了</p>
<p><img src="image-20200425180616954.png" alt="image-20200425180616954"></p>
<p><img src="image-20200425180741108.png" alt="image-20200425180741108"></p>
<p>修改一下，重新打开看一下</p>
<p><img src="image-20200425181111317.png" alt="image-20200425181111317"></p>
<p>随便输入一个会弹出一个窗口，显示flag error,推测还是MessageBox函数搞的鬼</p>
<p>用OD打开,查找一下这个函数.</p>
<p><img src="image-20200425181920029.png" alt="image-20200425181920029"></p>
<p>两个都下个断点，然后跑起来</p>
<p><img src="image-20200425182324981.png" alt="image-20200425182324981"></p>
<p>在这里有个跳转指令，然后上面有个字符串，猜想这个字符串可能就是我们要找的FLAG,结合字符串，在这两个地方下断点，然后单步执行</p>
<p><img src="image-20200425182749787.png" alt="image-20200425182749787"></p>
<p><img src="image-20200425182915052.png" alt="image-20200425182915052"></p>
<p>注意观察寄存器窗口，得到flag。</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><p>签到题这里就不说了</p>
<h2 id="打假"><a href="#打假" class="headerlink" title="打假"></a>打假</h2><p>这道题很简单，rar压缩包伪加密，用010打开,修改一下标志位就可以了。</p>
<p><img src="image-20200427111534700.png" alt="image-20200427111534700"></p>
<h1 id="安卓"><a href="#安卓" class="headerlink" title="安卓"></a>安卓</h1><h2 id="Anroid1"><a href="#Anroid1" class="headerlink" title="Anroid1"></a>Anroid1</h2><p>用Anroid killers打开这个apk，搜索字符串，得到flag</p>
<p><img src="image-20200426223640356.png" alt="image-20200426223640356"></p>
<h2 id="Anroid2"><a href="#Anroid2" class="headerlink" title="Anroid2"></a>Anroid2</h2><p>用apkide打开，查看字符串</p>
<p><img src="image-20200425192115507.png" alt="image-20200425192115507"></p>
<p>得出flag</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Dang Yanlin</span>
                    </p>
                
                
                
                

            </section>
        
	
    <section id="comments" class="comments">
      <style>
        .comments{margin:30px;padding:10px;background:#fff}
        @media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#fff}}
      </style>
      <div class="valine_comment"></div>
<!--载入js，在</body>之前插入即可-->
<!--Leancloud 操作库:-->
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<!--Valine 的核心代码库-->
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
  new Valine({
      el: '.valine_comment',
      app_id: 'fdPvG8U2K2eUc1GnjTey5gwg-gzGzoHsz',
      app_key: 'pSEhojKlFNh8eGAU3WfuDsDC',
      placeholder: '这里留言。。',
      notify: 'true',
      verify: 'true',
    });
</script>
    </section>

        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2020/05/07/Windows%E7%A8%8B%E5%BA%8F%E5%86%85%E9%83%A8%E6%93%8D%E4%BD%9C%E5%8E%9F%E7%90%86%E4%B9%8B%E6%B6%88%E6%81%AF%EF%BC%88%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%EF%BC%89/">Windows程序内部操作原理之消息（消息队列）</a>
            
            
        </section>

    </article>
</div>

        </div>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<footer id="footer" class="footer">
    <div class="copyright">
        <span>© 2020 | Powered by Dang Yanlin </span>
已经建站 <b id='build_time'></b>
		<span id="busuanzi_container_site_pv" style="display: none;">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>  <span id="busuanzi_container_site_uv" style="display: none;">本站访客数<span id="busuanzi_value_site_uv"</span>人</span>
    </div>
</footer>
<script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io/CDN/js/time.min.js"></script>
        <script>setInterval(show_date_time, 1000, '2020-04-10');</script>
<script>setInterval(show_date_time, 1000, '2020-04-10');</script>
    </div>
</body>
</html>
